{
  "ota_server": {
    "name": "LLMThings OTA Server",
    "ip": "192.168.1.100",
    "port": 8080,
    "protocol": "HTTP/REST",
    "endpoints": {
      "push": "/api/v1/ota/push",
      "pull": "/api/v1/ota/pull",
      "status": "/api/v1/ota/status"
    }
  },
  "firmware_management": {
    "storage_path": "/firmware/releases",
    "max_concurrent_updates": 5,
    "update_timeout_seconds": 300,
    "retry_policy": {
      "max_retries": 3,
      "retry_delay_seconds": 60,
      "exponential_backoff": true
    }
  },
  "available_firmware": {
    "latest_version": "1.2.3",
    "stable_version": "1.2.0",
    "1.2.3": {
      "release_date": "2026-01-10",
      "binary_url": "http://ota-server.local/firmware/v1.2.3.bin",
      "size_bytes": 524288,
      "signature": "MCwCFQCXm1G2jC1Uol8R3PlVKI3v4wIVAJyA+ub8L5M5m+qJkB9pW0K8DqJC",
      "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "changelog": "Bug fixes and performance improvements",
      "breaking_changes": false,
      "security_patches": [
        "CVE-2026-0001: Fixed firmware validation vulnerability",
        "CVE-2026-0002: Improved OTA download verification"
      ],
      "supported_devices": [
        "esp32_wroom",
        "esp32_s3",
        "esp32_c6"
      ],
      "minimum_battery_percent": 50,
      "estimated_download_time_seconds": 120
    },
    "1.2.0": {
      "release_date": "2025-12-15",
      "binary_url": "http://ota-server.local/firmware/v1.2.0.bin",
      "size_bytes": 512000,
      "signature": "MCwCFQCXm1G2jC1Uol8R3PlVKI3v4wIVAJyA+ub8L5M5m+qJkB9pW0K8DqJB",
      "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b854",
      "changelog": "Stable release",
      "breaking_changes": false,
      "security_patches": [],
      "supported_devices": [
        "esp32_wroom",
        "esp32_s3"
      ]
    },
    "1.1.0": {
      "release_date": "2025-11-01",
      "binary_url": "http://ota-server.local/firmware/v1.1.0.bin",
      "size_bytes": 480000,
      "signature": "MCwCFQCXm1G2jC1Uol8R3PlVKI3v4wIVAJyA+ub8L5M5m+qJkB9pW0K8DqJA",
      "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b853",
      "changelog": "Initial release",
      "breaking_changes": true,
      "supported_devices": [
        "esp32_wroom"
      ]
    }
  },
  "security": {
    "firmware_signing": {
      "enabled": true,
      "algorithm": "RSA-2048",
      "key_path": "/security/ota_server.key",
      "certificate_path": "/security/ota_server.crt"
    },
    "signature_verification": {
      "enabled": true,
      "public_key": {
        "algorithm": "RSA-2048",
        "device_key_path": "/security/device_public_key.pem"
      },
      "fail_on_invalid_signature": true
    },
    "update_allowed_roles": [
      "admin",
      "technician"
    ],
    "audit_logging": {
      "enabled": true,
      "log_path": "/logs/ota_updates.log",
      "retention_days": 90
    }
  },
  "scheduling": {
    "maintenance_window": {
      "enabled": true,
      "day": "sunday",
      "hour": 2,
      "duration_minutes": 60,
      "description": "Scheduled maintenance window for automatic updates"
    },
    "automatic_updates": {
      "enabled": false,
      "update_critical_security_patches": true,
      "update_stable_versions_only": true,
      "delay_after_release_days": 7
    }
  },
  "monitoring": {
    "update_tracking": {
      "enabled": true,
      "track_per_device": true,
      "track_per_version": true
    },
    "alerts": [
      {
        "condition": "update_failure_rate > 10%",
        "action": "notify_admin",
        "severity": "critical"
      },
      {
        "condition": "update_timeout",
        "action": "retry_and_notify",
        "severity": "warning"
      },
      {
        "condition": "signature_verification_failure",
        "action": "reject_update_and_alert",
        "severity": "critical"
      }
    ]
  },
  "toolchain": {
    "build_system": "esp-idf",
    "compiler": "xtensa-esp32-elf-gcc",
    "firmware_format": "bin",
    "partition_table": {
      "ota_0": {
        "offset": "0x10000",
        "size": "0xF0000",
        "description": "OTA Partition 0"
      },
      "ota_1": {
        "offset": "0x110000",
        "size": "0xF0000",
        "description": "OTA Partition 1"
      },
      "nvs": {
        "offset": "0x9000",
        "size": "0x6000",
        "description": "NVS (Non-Volatile Storage)"
      }
    }
  },
  "device_communication": {
    "push_mode": {
      "description": "OTA Server => Device: Server sends firmware directly to device",
      "endpoint": "POST /ota-update",
      "payload": {
        "firmware_binary": "base64_encoded_binary",
        "version": "semantic_version",
        "signature": "rsa2048_signature"
      },
      "device_response": {
        "verify_signature": true,
        "write_to_flash": true,
        "set_update_flag": true,
        "reboot": true
      },
      "retry_on_failure": true,
      "max_push_attempts": 3
    },
    "pull_mode": {
      "description": "Device => OTA Server: Device polls for updates",
      "endpoint": "GET /ota-update?device_id=esp32-001&version=1.0.0",
      "device_behavior": {
        "check_interval_seconds": 3600,
        "download_if_available": true,
        "verify_before_install": true,
        "automatic_installation": false
      }
    }
  }
}
