{
  "access_control": {
    "sensor": {
      "allowed_roles": ["nurse", "doctor", "admin", "technician"],
      "restricted_roles": ["guest", "visitor"],
      "required_permissions": ["read_sensor_data"],
      "operations": {
        "read": ["nurse", "doctor", "admin"],
        "configure": ["admin", "technician"],
        "delete": ["admin"]
      }
    },
    "camera": {
      "allowed_roles": ["nurse", "security", "admin"],
      "restricted_roles": ["guest", "visitor", "patient"],
      "required_permissions": ["read_video"],
      "operations": {
        "stream": ["nurse", "security", "admin"],
        "record": ["admin", "security"],
        "playback": ["nurse", "admin"],
        "delete": ["admin"]
      }
    },
    "actuator": {
      "allowed_roles": ["nurse", "doctor", "admin", "technician"],
      "restricted_roles": ["guest", "visitor"],
      "required_permissions": ["control_device"],
      "operations": {
        "control": ["nurse", "doctor", "admin"],
        "configure": ["admin", "technician"]
      }
    },
    "patient_monitor": {
      "allowed_roles": ["nurse", "doctor", "admin"],
      "restricted_roles": ["guest", "visitor"],
      "required_permissions": ["read_patient_data"],
      "operations": {
        "read": ["nurse", "doctor", "admin"],
        "alert": ["nurse", "doctor", "admin"]
      }
    },
    "display": {
      "allowed_roles": ["nurse", "admin", "technician"],
      "restricted_roles": ["guest", "visitor"],
      "required_permissions": ["control_display"],
      "operations": {
        "control": ["nurse", "admin"],
        "configure": ["admin", "technician"]
      }
    },
    "light": {
      "allowed_roles": ["nurse", "doctor", "admin", "technician"],
      "restricted_roles": ["guest"],
      "required_permissions": ["control_lighting"],
      "operations": {
        "control": ["nurse", "doctor", "admin"],
        "configure": ["admin", "technician"]
      }
    }
  },
  "privacy": {
    "camera": {
      "sensitive_area": true,
      "requires_explicit_consent": true,
      "restricted_users": ["guest", "visitor"],
      "minimum_role": "nurse",
      "data_retention_days": 7,
      "audit_required": true,
      "notes": "Camera feed is sensitive medical data"
    },
    "patient_monitor": {
      "sensitive_area": true,
      "requires_explicit_consent": true,
      "restricted_users": ["guest", "visitor"],
      "minimum_role": "nurse",
      "data_retention_days": 30,
      "audit_required": true,
      "notes": "Patient vital signs are protected health information"
    },
    "sensor": {
      "sensitive_area": false,
      "requires_explicit_consent": false,
      "restricted_users": [],
      "minimum_role": "guest",
      "data_retention_days": 30,
      "audit_required": false,
      "notes": "Environmental sensors (temperature, humidity)"
    },
    "location_tracking": {
      "enabled": false,
      "requires_explicit_consent": true,
      "restricted_users": ["patient"],
      "notes": "Location data collection requires informed consent"
    }
  },
  "data_classification": {
    "public": {
      "examples": ["device_status", "location_coordinates", "service_availability"],
      "encryption_required": false,
      "audit_required": false,
      "retention_policy": "indefinite"
    },
    "internal": {
      "examples": ["device_configuration", "network_topology", "system_logs"],
      "encryption_required": false,
      "audit_required": false,
      "retention_policy": "90_days",
      "access_restrictions": ["admin", "technician"]
    },
    "confidential": {
      "examples": ["sensor_readings", "environmental_data"],
      "encryption_required": true,
      "audit_required": true,
      "retention_policy": "30_days",
      "access_restrictions": ["nurse", "doctor", "admin"]
    },
    "restricted": {
      "examples": ["video_stream", "patient_vitals", "biometric_data"],
      "encryption_required": true,
      "audit_required": true,
      "retention_policy": "7_days",
      "access_restrictions": ["authorized_nurse", "authorized_doctor", "admin"],
      "notes": "Protected health information (PHI) - HIPAA compliance required"
    }
  },
  "secure_boot": {
    "enabled": true,
    "signed_firmware_required": true,
    "verification_method": "RSA-2048",
    "rollback_protection": true,
    "notes": "All ESP32 devices must use Secure Boot mode 1"
  },
  "ota_updates": {
    "enabled": true,
    "signature_verification": true,
    "signing_algorithm": "RSA-2048",
    "rollback_allowed": false,
    "version_pinning": true,
    "schedule_update_window": {
      "day": "sunday",
      "hour": 2,
      "duration_minutes": 30
    },
    "notes": "OTA updates require firmware signature verification"
  },
  "credential_management": {
    "device_identity": {
      "unique_id_format": "esp32-XXX",
      "certificate_format": "X.509",
      "certificate_validity_days": 365,
      "key_storage": "secure_element"
    },
    "user_credentials": {
      "password_policy": {
        "minimum_length": 12,
        "requires_uppercase": true,
        "requires_numbers": true,
        "requires_special_chars": true,
        "expiration_days": 90
      },
      "mfa_required": true,
      "session_timeout_minutes": 30
    },
    "api_credentials": {
      "token_format": "JWT",
      "token_validity_hours": 24,
      "refresh_token_validity_days": 30,
      "rotation_required": true
    }
  },
  "threat_model": {
    "device_tampering": {
      "mitigation": ["secure_boot", "flash_encryption"],
      "detection": ["integrity_verification", "anomaly_detection"]
    },
    "firmware_injection": {
      "mitigation": ["firmware_signing", "signature_verification"],
      "prevention": ["rollback_protection", "anti_downgrade"]
    },
    "man_in_the_middle": {
      "mitigation": ["tls_encryption", "certificate_pinning"],
      "protocols": ["HTTPS", "MQTT/TLS"]
    },
    "unauthorized_access": {
      "mitigation": ["access_control_list", "credential_verification"],
      "monitoring": ["audit_logging", "anomaly_detection"]
    },
    "data_breach": {
      "mitigation": ["encryption_at_rest", "encryption_in_transit"],
      "response": ["immediate_notification", "data_retention_limits"]
    }
  }
}
